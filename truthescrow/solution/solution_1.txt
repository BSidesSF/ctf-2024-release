truthescrow> listkeys

Citizen  0. (Nicholas Howgrave-Graham)
Public n: 0xd5c43a20a539a08c278a3fdabc3799a868f0700f96cb07dedaea3e18a02b747794a34c34623525d04255bdcc8099e7f20d32816ba66f0e65024f691c04c0fd313b7d178465c58b2c7e4281c39ca67fcb2d97a298e3e5a16456bba88be70349618fc946f1b33753b2f57f77961ee0efee2a5b4b1878d1adae2aa4c5d06f0a55a037cfeb7e6ceee202bdbe96bbd8c123e03a6939bfb7c413d8a5ce84ff49ddc7bae9c095f1747571cdc0cbc8a421a2ac80dca83cc78aacd813537bd831de9eff36d12b590fdbbf6640716290f13edb710cc9704737ff2a6853a44048add2237c54fddb46ba399db19525a6bf61589e503f002b8d741144b2fe54a3be1eb116eb9f
Public e: 0x10001
Private p: 0xf2e7b2780c58e76359a8e8c4c0776e4d11c9f82bdf403b80110b1edfbc2af4641a7660c68fb0c48bdc6ad0b187fc5adbf2abecad0098d5e9ed83c9cff50034fc[...]
Private q: 0x[...]75a623ffb6e27383be013a94552b238cdb9b534f9e6cf2677155b1261cb14d37cfd7d41e6356bf6a098c13309e5ff966a3df059909b792283ee5f31956f35497

Citizen  1. (Nadia Heninger Hovav Shacham)
Public n: 0xe20ab6113e8fae63375b4a2740f44946bcc4fadfa7ff3adf564bc30b1229e1f085b622dc7edaabb0de527bec83fbe7f2c57f9bae752ee5788a3f66211cadac6f1a7fdc75fc0899ca58efe94de7c3d2720c87ef699b202f7c182b568e7f662f69d459c3402ffa53fb6ba296a45a196f39d00e23f76d08fc991acac6ce7a9fdf34eb0ad0307e5a2d7268028554916649a220e5827bc8fc4331522961faf1e27fdd856f5b3db7831506e6f8d3339601f659061d0fb3430490df2910bb7bedf824ba8dd45e5b2bd236f1c6bb80c93291ed63d09fd181c3c4ccf37dc61bb5280c8536ec3d45efead1eeb4f42fe2fb24efd52c1e97cee044736ca7db19095cd873419b
Public e: 0x10001
Private d: 0x[...]a99f9cb3d32fd77736c2710fdf1fa0b0b98062abff34bda0924ecb9ef0117f0eb268ed3abf69bf676467e6037ec295d297b489eed86af81783996d757e352b63520adbf5


This relies on the observation that expanding (a + b) * (c + d) is ac + ad + bc + bd
But considering the order of magnitude difference:

(2^512*a + b) * (2^512*c + d) = 2^1024*ac + +2^512*ad + 2^512*bc + bd

So there isn't actually much overlap in the bits between these pieces (and we know the ad parts).

So using a and n we can find c approximately: (n - (2^512 * a * d)) \ (2^1024 * a)
This approximation may be off by a few of the lowest bits in c which is a few multiples of 2^512 which may need to be added.
In this example c was found exactly and q is just c + d no no extra 2^512 were needed.


GP/PARI> n = 0xd5c43a20a539a08c278a3fdabc3799a868f0700f96cb07dedaea3e18a02b747794a34c34623525d04255bdcc8099e7f20d32816ba66f0e65024f691c04c0fd313b7d178465c58b2c7e4281c39ca67fcb2d97a298e3e5a16456bba88be70349618fc946f1b33753b2f57f77961ee0efee2a5b4b1878d1adae2aa4c5d06f0a55a037cfeb7e6ceee202bdbe96bbd8c123e03a6939bfb7c413d8a5ce84ff49ddc7bae9c095f1747571cdc0cbc8a421a2ac80dca83cc78aacd813537bd831de9eff36d12b590fdbbf6640716290f13edb710cc9704737ff2a6853a44048add2237c54fddb46ba399db19525a6bf61589e503f002b8d741144b2fe54a3be1eb116eb9f

GP/PARI> a = 0xf2e7b2780c58e76359a8e8c4c0776e4d11c9f82bdf403b80110b1edfbc2af4641a7660c68fb0c48bdc6ad0b187fc5adbf2abecad0098d5e9ed83c9cff50034fc

GP/PARI> d = 0x75a623ffb6e27383be013a94552b238cdb9b534f9e6cf2677155b1261cb14d37cfd7d41e6356bf6a098c13309e5ff966a3df059909b792283ee5f31956f35497

GP/PARI> approx_c = (n - (2^512 * a * d)) \ (2^1024 * a)

GP/PARI> n % (approx_c * 2^512 + d)

GP/PARI> p = n / (approx_c * 2^512 + d)

GP/PARI> q = n / p




Enter citizen (by number) to read unread truth? 0

Welcome Nicholas(?), before we continue, you must prove it's you

Please provide the signature for 136921517205381429574091850077124231294 : 26728371630125374435350461633052833376787582150955261860768083435146286154695684175789182650287538931737940471814141342740271418880522707996835006492740633299261756615425775253181058764636912207846728196839778247442337275285149467192305091057572363747255393489659513534089062983398038068440195534121304565895737093115644643119436772077918391336793282813296817641656561469181664720430862615913412247454102016168604371054023722996387910415384972578952751670793350090489180980630257500095525405291072563240338736009914977582321249280303749548892812297361502062665438505155171338399008237530821086073439518500119816595629
Truth 1: Nick, don't fight it, you know it to be true CTF{we_are_the_oprah_of_private_key_bits}

